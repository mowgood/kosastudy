## [day59] 2023.06.16 금 학습 내용 정리
1. 쿠버네티스
2. 깃허브액션 CI/CD
---
## 1. 쿠버네티스  
### 컨테이너  
- 가상머신과 비교하여 컨테이너 생성이 쉽고 효율적
- 컨테이너 이미지를 이용한 배포와 롤백이 간단
- 언어나 프레임워크에 상관없이 애플리케이션을 동일한 방식으로 관리
- 개발, 테스팅, 운영 환경은 물론 로컬 피시와 클라우드까지 동일한 환경을 구축
- 특정 클라우드 벤더에 종속적이지 않음

### 컨테이너 오케스트레이션(Container Orchestration)  
컨테이너화 된 애플리케이션에 대한 자동화된 설정, 관리 및 제어 체계

### 쿠버네티스 클러스터 구축과 동작 방법  
- 마스터 노드 : 제어 노드
- 워커 노드 : 실제 동작 담당  

|마스터 노드 역할|워커 노드 역할|
|--|--|
|컨테이너 실행 안함|실제 서버 역할|
|워커 노드에서 실행되는 컨테이너 관리|컨테이너가 실제 동작하는 서버|
|컨테이너 엔진 설치 안됨|컨테이너 엔진 설치|

### 파드(pod)  
- 쿠버네티스에서 관리하는 컨테이너 단위
- 컨테이너와 볼륨을 하나로 묶은 것(볼륨이 없는 경우도 있음)
- 1개의 컨테이너 또는 여러 개의 컨테이너로 구성될 수도 있음
- 쿠버네티스에서 생성하고 관리할 수 있는 배포 가능한 가장 작은 컴퓨팅 단위 

### 서비스(service)  
- 여러 개의 파드를 하나로 관리
- 서비스가 관리하는 파드는 모두 동일한 구성으로 이루어짐
- 서비스의 역할 : 로드밸런스(부하분산) 역할
    - 각 서비스는 자동으로 고정된 IP주소(clusterIP)를 부여받으며, 이 주소로 통신
    - 여러 개의 파드로 구성되어도 IP 주소는 1개만 부여

### 레플리카세트  
- 파드의 수를 관리하는 역할
- 장애 등으로 파드가 종료되었을 때 부족한 파드를 보충하거나 저의 파일에 파드 수가 감소하면 파드 수를 실제로 감소시킴
- 레플리카 세트의 목적
    - 레플리카 파드 집합의 실행을 항상 안정적으로 유지
    - 레플리카셋은 보통 명시된 동일 파드 개수에 대한 가용성을 보증하는데 사용

### 리플리카  
- 리클리카세트가 관리하는 동일한 구성의 파드  
- 파드의 수를 조정하는 것을 '레플리카의 수를 조정' 또는 '레플리카의 수를 결정'한다고 표현
- 레플리카세트가 관리하는 파드를 레플리카라고 한다. 

## 2. 깃허브액션 CI/CD
### CI  
빌드/테스트 자동화 과정  
- 개발자를 위한 자동화 프로세스인 지속적인 통합(Continuous Integration)을 의미한다.
- 애플리케이션에 대한 새로운 코드 변경 사항이 정기적으로 빌드 및 테스트되어 공유 리포지토리에 통합된다.
    - 여러 명의 개발자가 동시에 애플리케이션 개발과 관련된 코드 작업을 할 경우 서로 충돌할 수 있는 문제를 해결할 수 있다. 

### CD  
배포 자동화 과정  
- 지속적인 서비스 제공(Couninuous Delivery) 또는 지속적인 배포(Continuous Deployment)를 의미
- 지속적 배포
    - 빌드, 테스트 및 배포 단계를 자동화하는 DevOps 방식을 논리적 극한까지 끌어올린다.
    - 수동 개입 없이 변경 사항이 프로덕션에 자동으로 배포된다.
    - 품질 저하 없이 최대한 빨리 사용자에게 새로운 기능을 제공할 수 있다. 

### CI/CD 구축을 지원하는 툴의 종류  
- Jenkins
- CircleCI
- TravisCI
- Github Actions
- etc

### 깃허브 액션  
깃허브에서 제공하는 CI/CD 플랫폼으로 빌드, 테스트, 배포를 자동화시키는 파이프라인을 만들 수 있다.
- 깃허브에 소스코드가 올라(push, merge)오면 테스트, 빌드, 도커 이미지 빌드, 도커 허브 업로드 또는 서버리스를 위한 클라우드로의 업로드 등을 자동으로 수행하는 파이프라인을 구축할 수 있다. 

#### 구성 요소
- Event  
워크플로우 실행을 발동시키는 특정한 활동  
깃허브에 소스코드를 푸시하면 발생하는 push event, 머지하면 발생하는 ppull request event 등 깃허브에서 발생하는 대부분의 작업을 event로 정의할 수 있음
- Workflows  
자동화하려는 내용을 담고 있는 스크립트(자동화 해놓은 작업 과정)  
한 개 이상의 job을 실행할 수 있는 자동화된 작업  
YAML 파일로 저장되며 event 발생시 실행됨
- Jobs  
어떤 이벤트가 발생했을 때 독립된 환경에서 실행되야 하는 일련의 일을 하나 이상의 작업(job)이 하나의 워크플로우(workflow)를 구성  
여러 step들로 구성됨  
각각의 step들은 일종의 shell script 처럼 실행  
Job은 다른 Job에 의존관계를 가질 수 있으며, 디폴트는 모든 잡들이 병렬적으로 실행 됨
- Actions  
복잡하고 자주 반복되는 작업을 정의한 커스텀 어플리케이션(공개적으로 오픈된 액션들)  
워크플로우 안에서 자주 반복되는 코드를 미리 정의해 코드의 양을 줄일 수 있음  
깃허브 마켓플레이스를 통해 공용 Action 또는 다른 사람들이 만든 Action을 사용할 수 있음
- Runners  
job을 실행시키는 역할  
VM Machine 또는 Docker Container 기반에서 job 마다 개별적이고 독립적으로 실행시킴 

### 액션(Action) 활용  
빈번하게 반복되는 step을 재사용하기 용이하도록 GitHub Actions에서 제공되는 일종의 작업 공유 매커니즘.  
- 하나의 코드 저장소 범위 내에서 여러 워크플로우 간에서 공유할 수 있다.
- 공개 코드 저장소를 통해 액션을 공유하면 GitHub 상의 모든 코드 저장소에서 사용 가능해진다. 
- 체크아웃(Checkout) 액션
    - GitHub의 코드 저장소에 올려둔 코드를 CI 서버로 내려 받은 후 특정 브랜치로 전환하는 행위
