## [day58] 2023.06.15 목 학습 내용 정리
1. Dockerfile 스크립트
2. 도커 허브
3. 도커 컴포즈
4. AWS
---
## 1. Dockerfile 스크립트  
### Dockerfile 스크립트로 이미지 생성하기  
Dockerfile에 컨테이너에 넣을 이미지나 실행할 명령 등을 기술  
`docker build -t 생성할이미지이름 Dockerfile경로`  
- Dockerfile 스크립트 예시    
    ```
    FROM opendjk:11-jdk
    ARG JAR_FILE=build/libs/*.jar
    COPY ${JAR_FILE} app.jaSr
    ENTRYPOINT ["java", "-jar", "/app.jar"]  
    ```  

- Dockerfile 스크립트에 사용되는 주요 명령  
    - FROM : 토대가 되는 이미지를 지정
    - ADD : 이미지에 파일이나 폴더를 추가
    - COPY : 이미지에 파일이나 폴더를 추가
    - RUN : 이미지를 빌드할 때 실행할 명령어를 지정
    - CMD : 컨테이너를 실행할 때 실행할 명령어를 지정
    - ENTRYPOINT : 컨테이너를 실행할 때 실행할 명령어를 강제 지정

- 이미지를 호스트 컴퓨터의 파일시스템에 tar 형식으로 저장  
`docker save -o 파일_이름.tar 이미지_이름`

- 도커 엔진으로 가져올 때는 load 명령 이용  
`docker load -i 파일_이름.tar`

### 컨테이너 개조 방법 (두 가지 방법 혼용)
- 파일 복사와 마운트
- 컨테이너에서 리눅스 명령 이용

## 2. 도커 허브   
도커 이미지 저장소  
- 직접 만든 이미지를 도커 허브에 업로드할 수 있고, 비공개로 도커 허브와 같은 장소(레지스트리)를 만들 수도 있음  
- 도커 레지스트리 : 이미지 배포하는 장소
- 도커 허브 : 도커 제작사에서 운영하는 공식 도커 레지스트리

### 레지스트리(Registry)  
- 도커 이미지를 관리하는 공간
- 도커 허브를 기본 레지스트리로 사용
- 레지스트리는 Docker Hub, Private Docker Hub, 회사 내부용 등으로 나뉨

### 리포지토리(Repository)  
- 레지스트리 내에 도커 이미지가 저장되는 공간
- 이미지 이름이 리포지토리명으로 사용되기도 함
- 깃허브의 리포지토리와 비슷한 역할

### 태그(Tag)  
- 같은 이미지이지만 버전별로 내용이 다름
- 해당 이밎를 설명하는 버전 정보를 주로 입력
- 보통 latest 태그가 붙은 최신 버전을 사용

## 3. 도커 컴포즈  
docker Compose  
여러 개의 컨테이너를 묶어서 관리하는 기술  
- 시스템 관련 명령들을 하나의 파일에 작성하여 한 번에 시스템 전체를 실행하고 종료 및 폐기까지 실행하도록 도와주는 도구  
- 단일 서버에서 여러 개의 컨테이너를 하나의 서비스로 정의해 컨테이너의 묶음으로 관리할 수 있는 작업 환경을 제공하는 관리 도구  
- 시스템 구축과 관련된 명령어를 하나의 텍스트 파일(정의 파일, Compose File)에 기재해 명령어 한번에 시스템 전체를 실행하고 종료
- YAML 포맷의 정의 파일 사용

- 명령어
    - up  
    정의 파일의 내용대로 이미지를 내려 받고 컨테이너를 생성 및 실행, 네트워크나 볼륨도 정의 가능
    - down  
    컨테이너와 네트워크를 정지 및 삭제
    - stop  
    컨테이너와 네트워크를 삭제없이 종료만 진행  
    
> 도커 컴포즈와 Dockerfile 스크립트 차이점  
> - 도커 컴포즈 : 컨테이너와 주변 환경 및 네트워크와 볼륨까지 만들 수 있다.
> - Dockerfile 스크립트 : 이미지를 만들기 위한 것으로 네트워크나 볼륨은 만들 수 없다.  

## 4. AWS  
### 클라우드 컴퓨팅  
서로 다른 물리적인 위치에 존재하는 컴퓨팅 자원을 가상화 기술로 통합해 제공하는 기술.  
사용자는 클라우드 컴퓨팅 환경을 통해 웹에만 접속하면 언제 어디서나 원하는 컴퓨팅 자원을 클라우드로부터 제공받아 사용할 수 있다.
- 퍼블릭 클라우드 (Public Cloud)  
클라우드 서비스 기업이 인터넷을 통해 불특정 다수의 기업, 개인에게 컴퓨팅 리소스를 빌려주는 서비스
    - 장점
        - 유지관리 용이
        - 사용량에 따른 비용 지불 가능
        - 유동적으로 리소스 활용 가능
    - 단점
        - 데이터가 외부에 존재한다는 리스크
    - 주요 적용 분야
        - 메일, 일정관리 등 개인용 및 중소형 웹 비즈니스 서비스
- 프라이빗 클라우드 (Private Cloud)  
기업이 직접 클라우드 환경을 구축하고 내부에서만 컴퓨팅 리소스를 사용하는 서비스
    - 장점
        - 강력한 보안
        - 비즈니스에 맞는 클라우드 환경 조성 가능
    - 단점 
        - 클라우드 관리를 위한 자체 전문 인력 필요
    - 주요 적용 분야
        - ERP 등의 기업 핵심 애플리케이션 및 중대형 웹 비즈니스 서비스 
- 하이브리드 클라우드 (Hybrid 클라우드)  
Private와 Pulbic의 단점 보완
    - Private 클라우드  
        - 보안성 확보가 필요한 중요 업무
    - Public 클라우드
        - 중요도가 낮은 업무 (백업 등)

### EC2  
AWS에서 제공하는 클라우드 컴퓨팅 서비스.  
이 서비스를 통해 아마존이 각 세계에 구축한 데이터 센터의 서버용 컴퓨터들의 자원을 원격으로 사용할 수 있다. 아마존으로부터 한 대의 컴퓨터를 임대하는 것이다. 
- 장점
    - 용량을 늘리거나 줄일 수 있다. (탄력적)
    - 사용한만큼 지불하므로 저렴하다.
    - 사용자가 인스턴스를 완전히 제어할 수 있다.
    - 보안 및 네트워크 구성, 스토리지 관리 효과적이다. 